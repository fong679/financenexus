<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="apple-mobile-web-app-title" content="FinanceNexus"/>
<meta name="theme-color" content="#4F46E5"/>
<meta name="description" content="Fiji home loan, vehicle, personal loan and savings calculator with live bank rates"/>
<title>Finance Calculator ‚Äî Fiji</title>
<link rel="manifest" href="manifest.json"/>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='8' fill='%234F46E5'/><text x='50%' y='56%' dominant-baseline='middle' text-anchor='middle' font-size='18'>üí∞</text></svg>"/>
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect width='180' height='180' rx='40' fill='%234F46E5'/><text x='50%' y='56%' dominant-baseline='middle' text-anchor='middle' font-size='110'>üí∞</text></svg>"/>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root{--primary:#4F46E5;--primary-light:#818CF8;--primary-dim:rgba(79,70,229,0.15);--emerald:#10B981;--emerald-light:#6EE7B7;--slate:#0F172A;--slate-light:#1E293B;--border:#334155;--muted:#94A3B8;--text:#F8FAFC;--surface:#1E293B;--surface-high:#263346;--accent:#F59E0B;--topbar-bg:rgba(15,23,42,0.92);--input-bg:#0F172A;--input-color:#F8FAFC;--news-bg:#182030;--danger:#EF4444;}
:root.light{--primary:#4338CA;--primary-light:#6366F1;--primary-dim:rgba(99,102,241,0.12);--emerald:#059669;--emerald-light:#047857;--slate:#F1F5F9;--slate-light:#E2E8F0;--border:#CBD5E1;--muted:#64748B;--text:#0F172A;--surface:#FFFFFF;--surface-high:#F1F5F9;--accent:#D97706;--topbar-bg:rgba(255,255,255,0.95);--input-bg:#F8FAFC;--input-color:#0F172A;--news-bg:#F8FAFC;}
*{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
body{background:var(--slate);color:var(--text);font-family:'DM Sans',sans-serif;font-size:16px;line-height:1.5;min-height:100vh;transition:background 0.3s,color 0.3s;}
::-webkit-scrollbar{width:7px;height:7px;}::-webkit-scrollbar-track{background:var(--slate);}::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px;}

/* AUTH */
#auth-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--slate);background-image:radial-gradient(ellipse at 20% 10%,rgba(79,70,229,0.18) 0%,transparent 55%),radial-gradient(ellipse at 80% 90%,rgba(16,185,129,0.12) 0%,transparent 55%);}
.auth-card{width:100%;max-width:440px;margin:24px;background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:40px 36px;box-shadow:0 25px 60px rgba(0,0,0,0.4);}
.auth-logo{display:flex;align-items:center;gap:12px;margin-bottom:32px;}
.auth-logo-icon{width:44px;height:44px;border-radius:11px;background:linear-gradient(135deg,var(--primary),var(--primary-light));display:flex;align-items:center;justify-content:center;font-size:22px;}
.auth-logo-name{font-size:20px;font-weight:700;letter-spacing:-0.02em;}
.auth-logo-sub{font-size:11px;color:var(--muted);letter-spacing:0.06em;text-transform:uppercase;}
.auth-tabs{display:flex;gap:4px;background:var(--slate);border-radius:10px;padding:4px;margin-bottom:28px;}
.auth-tab{flex:1;padding:9px;border-radius:7px;border:none;cursor:pointer;font-size:14px;font-weight:600;font-family:'DM Sans',sans-serif;background:transparent;color:var(--muted);transition:all 0.2s;}
.auth-tab.active{background:var(--primary);color:white;box-shadow:0 2px 8px rgba(79,70,229,0.4);}
.auth-panel{display:none;}.auth-panel.active{display:block;}
.auth-field{margin-bottom:18px;}
.auth-label{display:block;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:7px;}
.auth-input{width:100%;background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:9px;padding:11px 14px;font-size:15px;font-family:'DM Sans',sans-serif;outline:none;transition:border 0.2s;}
.auth-input:focus{border-color:var(--primary-light);}
.auth-btn{width:100%;padding:13px;border-radius:10px;border:none;cursor:pointer;font-size:15px;font-weight:700;font-family:'DM Sans',sans-serif;background:linear-gradient(135deg,var(--primary),var(--primary-light));color:white;box-shadow:0 4px 15px rgba(79,70,229,0.35);transition:all 0.2s;margin-top:4px;}
.auth-btn:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(79,70,229,0.45);}
.auth-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none;}
.auth-msg{padding:11px 14px;border-radius:9px;font-size:13px;margin-top:14px;display:none;}
.auth-msg.success{background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);color:var(--emerald-light);}
.auth-msg.error{background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:#FCA5A5;}
.auth-divider{text-align:center;font-size:12px;color:var(--muted);margin:18px 0;}
.auth-footer{text-align:center;font-size:12px;color:var(--muted);margin-top:20px;}

/* TOPBAR */
.topbar{position:sticky;top:0;z-index:100;display:flex;align-items:center;justify-content:space-between;padding:0 24px;height:64px;background:var(--topbar-bg);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);}
.topbar-brand{display:flex;align-items:center;gap:12px;}
.brand-icon{width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,var(--primary),var(--primary-light));display:flex;align-items:center;justify-content:center;font-size:19px;}
.brand-name{font-size:17px;font-weight:700;letter-spacing:-0.01em;}
.brand-sub{font-size:11px;color:var(--muted);letter-spacing:0.05em;text-transform:uppercase;}
.topbar-right{display:flex;align-items:center;gap:10px;}
.icon-btn{width:38px;height:38px;border-radius:9px;border:1px solid var(--border);background:var(--surface-high);display:flex;align-items:center;justify-content:center;font-size:17px;cursor:pointer;transition:all 0.2s;}
.icon-btn:hover{border-color:var(--primary);}
.live-badge{padding:5px 13px;border-radius:99px;font-size:11px;font-weight:600;background:rgba(16,185,129,0.15);color:var(--emerald-light);border:1px solid rgba(16,185,129,0.3);letter-spacing:0.05em;}

/* PROFILE DROPDOWN */
.profile-wrap{position:relative;}
.user-chip{display:flex;align-items:center;gap:9px;padding:5px 13px 5px 5px;background:var(--surface-high);border:1px solid var(--border);border-radius:99px;cursor:pointer;transition:all 0.2s;user-select:none;}
.user-chip:hover{border-color:var(--primary-light);background:var(--surface);}
.user-chip.open{border-color:var(--primary);background:var(--surface);}
.user-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--primary-light));display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:white;flex-shrink:0;}
.user-info{display:flex;flex-direction:column;}
.user-name{font-size:13px;font-weight:700;max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.2;}
.user-email-small{font-size:10px;color:var(--muted);max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.2;}
.user-chevron{font-size:10px;color:var(--muted);transition:transform 0.2s;margin-left:2px;}
.user-chip.open .user-chevron{transform:rotate(180deg);}

.profile-dropdown{position:absolute;top:calc(100% + 10px);right:0;width:240px;background:var(--surface);border:1px solid var(--border);border-radius:14px;box-shadow:0 16px 48px rgba(0,0,0,0.35);z-index:200;overflow:hidden;display:none;animation:dropIn 0.18s ease;}
.profile-dropdown.open{display:block;}
@keyframes dropIn{from{opacity:0;transform:translateY(-6px);}to{opacity:1;transform:translateY(0);}}

.profile-header{padding:16px 16px 12px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;}
.profile-header-avatar{width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--primary-light));display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:white;flex-shrink:0;}
.profile-header-name{font-size:14px;font-weight:700;color:var(--text);line-height:1.3;}
.profile-header-email{font-size:11px;color:var(--muted);margin-top:1px;word-break:break-all;}

.profile-menu{padding:6px;}
.profile-menu-item{display:flex;align-items:center;gap:11px;padding:10px 12px;border-radius:9px;cursor:pointer;border:none;width:100%;background:transparent;color:var(--text);font-family:'DM Sans',sans-serif;font-size:14px;font-weight:500;text-align:left;transition:all 0.15s;}
.profile-menu-item:hover{background:var(--surface-high);}
.profile-menu-item.danger{color:var(--danger);}
.profile-menu-item.danger:hover{background:rgba(239,68,68,0.1);}
.profile-menu-icon{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;}
.profile-menu-icon.blue{background:rgba(79,70,229,0.15);}
.profile-menu-icon.red{background:rgba(239,68,68,0.12);}
.profile-menu-divider{height:1px;background:var(--border);margin:4px 8px;}
.profile-menu-label{display:flex;flex-direction:column;}
.profile-menu-desc{font-size:11px;color:var(--muted);font-weight:400;margin-top:1px;}

/* Change Password Modal */
.cpw-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:500;align-items:center;justify-content:center;}
.cpw-modal.open{display:flex;}
.cpw-card{background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:32px;max-width:400px;width:calc(100% - 40px);box-shadow:0 25px 60px rgba(0,0,0,0.4);}
.cpw-title{font-size:18px;font-weight:700;margin-bottom:4px;}
.cpw-sub{font-size:13px;color:var(--muted);margin-bottom:22px;}
.cpw-field{margin-bottom:16px;}
.cpw-label{display:block;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:7px;}
.cpw-input{width:100%;background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:9px;padding:11px 14px;font-size:15px;font-family:'DM Sans',sans-serif;outline:none;transition:border 0.2s;}
.cpw-input:focus{border-color:var(--primary-light);}
.cpw-msg{padding:10px 13px;border-radius:8px;font-size:13px;margin-top:12px;display:none;}
.cpw-msg.success{background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);color:var(--emerald-light);}
.cpw-msg.error{background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:#FCA5A5;}
.cpw-actions{display:flex;gap:10px;margin-top:18px;}
.cpw-btn{flex:1;padding:11px;border-radius:9px;border:none;cursor:pointer;font-size:14px;font-weight:700;font-family:'DM Sans',sans-serif;transition:all 0.2s;}
.cpw-btn.primary{background:linear-gradient(135deg,var(--primary),var(--primary-light));color:white;}
.cpw-btn.primary:hover{opacity:0.9;}
.cpw-btn.primary:disabled{opacity:0.5;cursor:not-allowed;}
.cpw-btn.cancel{background:transparent;border:1px solid var(--border);color:var(--text);}
.cpw-btn.cancel:hover{border-color:var(--primary);}

/* APP LAYOUT */
#app-screen{display:none;}
.app-body{display:flex;min-height:calc(100vh - 64px);}

/* LEFT SIDEBAR */
.sidebar{width:248px;flex-shrink:0;padding:18px 12px;border-right:1px solid var(--border);background:rgba(30,41,59,0.3);display:flex;flex-direction:column;gap:4px;transition:width 0.25s ease,padding 0.25s ease;position:relative;}
.sidebar.collapsed{width:64px;padding:18px 8px;}
.sidebar.collapsed .nav-label,.sidebar.collapsed .nav-desc,.sidebar.collapsed .nav-divider{display:none;}
.sidebar.collapsed .nav-item{justify-content:center;padding:12px 6px;border-left:3px solid transparent;}
.sidebar.collapsed .nav-icon{margin:0;}
.sidebar-toggle{position:absolute;top:14px;right:-14px;width:28px;height:28px;border-radius:50%;background:var(--surface);border:1px solid var(--border);color:var(--muted);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:12px;z-index:10;transition:all 0.2s;box-shadow:0 2px 8px rgba(0,0,0,0.2);}
.sidebar-toggle:hover{background:var(--primary);color:white;border-color:var(--primary);}
.nav-item{display:flex;align-items:center;gap:12px;padding:12px 13px;border-radius:11px;cursor:pointer;border:none;width:100%;background:transparent;color:var(--muted);text-align:left;transition:all 0.18s;border-left:3px solid transparent;}
.nav-item:hover{background:var(--surface-high);color:var(--text);}
.nav-item.active{background:var(--primary-dim);border-left-color:var(--primary-light);color:white;}
.nav-icon{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;background:rgba(51,65,85,0.5);font-size:16px;flex-shrink:0;}
.nav-item.active .nav-icon{background:rgba(79,70,229,0.35);}
.nav-label{font-size:14px;font-weight:600;}
.nav-desc{font-size:11px;opacity:0.65;margin-top:2px;}
.nav-divider{height:1px;background:var(--border);margin:6px 4px;}

/* CONTENT */
.content{flex:1;padding:26px;overflow-y:auto;}
.page-header{display:flex;align-items:center;gap:13px;margin-bottom:26px;}
.page-header-icon{font-size:28px;}
.page-title{font-size:24px;font-weight:700;letter-spacing:-0.02em;}
.page-sub{font-size:13px;color:var(--muted);margin-top:3px;}

/* PANELS */
.panel{background:var(--surface);border-radius:16px;padding:24px;border:1px solid var(--border);box-shadow:0 3px 14px rgba(0,0,0,0.07);}
.analysis-panel{background:linear-gradient(145deg,rgba(79,70,229,0.07),rgba(30,41,59,0.4));border:1px solid rgba(129,140,248,0.18);margin-bottom:18px;}
.analysis-text{font-size:14px;color:var(--text);line-height:1.65;}
.analysis-text strong{color:var(--primary-light);font-weight:600;}
.section-title{font-size:12px;font-weight:700;letter-spacing:0.08em;text-transform:uppercase;color:var(--text);border-left:4px solid var(--primary);padding-left:11px;margin:0 0 18px;display:flex;align-items:center;gap:8px;}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;}
.grid-col{display:flex;flex-direction:column;gap:18px;}
.calc-grid{display:grid;grid-template-columns:380px 1fr;gap:18px;}

/* STAT CARDS */
.stat-card{background:var(--surface-high);border:1px solid var(--border);border-radius:12px;padding:15px 18px;}
.stat-card.accent{background:linear-gradient(135deg,rgba(79,70,229,0.18),rgba(129,140,248,0.05));border-color:rgba(129,140,248,0.28);}
.stat-label{font-size:11px;text-transform:uppercase;letter-spacing:0.05em;color:var(--muted);font-weight:600;}
.stat-value{font-family:'DM Mono',monospace;font-size:24px;font-weight:700;color:var(--text);margin-top:6px;letter-spacing:-0.02em;}
.stat-card.accent .stat-value{color:var(--primary-light);font-size:30px;}

/* INPUTS */
.input-group{display:flex;flex-direction:column;gap:8px;margin-bottom:20px;}
.input-row{display:flex;justify-content:space-between;align-items:center;}
.input-label{font-size:13px;font-weight:600;color:#cbd5e1;}
.input-number{background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:8px;padding:7px 11px;width:128px;text-align:right;font-size:14px;font-family:'DM Mono',monospace;outline:none;transition:border 0.2s;}
.input-number:focus{border-color:var(--primary-light);}
input[type=range]{-webkit-appearance:none;width:100%;height:5px;border-radius:99px;background:var(--surface-high);cursor:pointer;margin-top:3px;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--primary);border:3px solid var(--primary-light);cursor:pointer;box-shadow:0 2px 5px rgba(0,0,0,0.25);}
.range-hints{display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-top:1px;}
.toggle-group{display:flex;gap:7px;margin-top:6px;}
.toggle-btn{flex:1;padding:8px;border-radius:8px;cursor:pointer;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:13px;font-family:'DM Sans',sans-serif;font-weight:500;transition:all 0.2s;text-transform:capitalize;}
.toggle-btn.active{border-color:var(--primary);background:rgba(79,70,229,0.18);color:white;}

/* SAVE BAR */
.save-bar{display:flex;align-items:center;gap:10px;padding:12px 16px;background:linear-gradient(135deg,rgba(79,70,229,0.1),rgba(16,185,129,0.06));border:1px solid rgba(79,70,229,0.2);border-radius:11px;margin-bottom:18px;}
.save-bar input{flex:1;background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:8px;padding:7px 11px;font-size:14px;font-family:'DM Sans',sans-serif;outline:none;}
.save-bar input:focus{border-color:var(--primary-light);}
.btn{padding:8px 16px;border-radius:8px;border:none;cursor:pointer;font-size:13px;font-weight:700;font-family:'DM Sans',sans-serif;transition:all 0.2s;display:inline-flex;align-items:center;gap:5px;}
.btn-primary{background:var(--primary);color:white;}.btn-primary:hover{background:var(--primary-light);}
.btn-emerald{background:var(--emerald);color:white;}.btn-emerald:hover{opacity:0.85;}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--text);}.btn-outline:hover{border-color:var(--primary);background:var(--primary-dim);}
.btn-danger{background:var(--danger);color:white;font-size:12px;padding:5px 11px;}.btn-danger:hover{opacity:0.85;}
.btn-sm{padding:6px 12px;font-size:12px;}
.btn:disabled{opacity:0.5;cursor:not-allowed;}

/* SAVED PANEL */
.saved-list{display:flex;flex-direction:column;gap:10px;margin-top:6px;}
.saved-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:15px 17px;transition:border 0.2s;}
.saved-card:hover{border-color:var(--primary);}
.saved-card-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:8px;}
.saved-card-title{font-size:15px;font-weight:700;color:var(--text);}
.saved-card-type{font-size:10px;padding:3px 8px;border-radius:99px;font-weight:700;letter-spacing:0.06em;text-transform:uppercase;}
.type-mortgage{background:rgba(79,70,229,0.18);color:var(--primary-light);}
.type-vehicle{background:rgba(16,185,129,0.18);color:var(--emerald-light);}
.type-personal{background:rgba(245,158,11,0.18);color:var(--accent);}
.type-savings{background:rgba(148,163,184,0.18);color:var(--muted);}
.saved-card-summary{font-size:13px;color:var(--muted);margin-bottom:10px;line-height:1.5;}
.saved-card-actions{display:flex;gap:7px;flex-wrap:wrap;}
.saved-date{font-size:11px;color:var(--muted);margin-top:7px;}

/* COMPARE */
.compare-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:14px;}
.compare-col{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:15px;}
.compare-col-header{font-size:13px;font-weight:700;color:var(--text);margin-bottom:10px;padding-bottom:9px;border-bottom:1px solid var(--border);}
.compare-row{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid rgba(51,65,85,0.18);}
.compare-row:last-child{border-bottom:none;}
.compare-key{font-size:12px;color:var(--muted);}
.compare-val{font-size:13px;font-weight:600;font-family:'DM Mono',monospace;color:var(--text);}
.compare-val.highlight{color:var(--emerald-light);}
.compare-empty{text-align:center;color:var(--muted);font-size:13px;padding:40px 20px;}
.compare-selector{display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap;}
select{flex:1;background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:9px;padding:9px 11px;font-family:'DM Sans',sans-serif;font-size:14px;outline:none;}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:500;display:none;align-items:center;justify-content:center;}
.modal-overlay.open{display:flex;}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:17px;padding:30px;max-width:480px;width:calc(100% - 40px);box-shadow:0 25px 60px rgba(0,0,0,0.4);}
.modal-title{font-size:18px;font-weight:700;margin-bottom:5px;}
.modal-sub{font-size:13px;color:var(--muted);margin-bottom:18px;}
.share-link-box{display:flex;gap:8px;}
.share-link-input{flex:1;background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:8px;padding:8px 11px;font-size:12px;font-family:'DM Mono',monospace;outline:none;}
.modal-actions{display:flex;justify-content:flex-end;gap:10px;margin-top:18px;}

/* TOAST */
#toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface-high);border:1px solid var(--border);border-radius:10px;padding:11px 20px;font-size:14px;font-weight:600;z-index:9999;opacity:0;transition:all 0.35s;pointer-events:none;white-space:nowrap;}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
#toast.success{border-color:var(--emerald);color:var(--emerald-light);}
#toast.error{border-color:var(--danger);color:#FCA5A5;}

/* CHARTS & TABLE */
.chart-wrap{position:relative;width:100%;margin-top:7px;}
.progress-bar-wrap{background:var(--surface-high);border-radius:99px;height:10px;overflow:hidden;margin-top:8px;border:1px solid var(--border);}
.progress-bar-fill{height:100%;border-radius:99px;background:linear-gradient(90deg,var(--primary),var(--primary-light));transition:width 0.4s ease;}
.amort-table-wrap{max-height:250px;overflow-y:auto;border-radius:10px;border:1px solid var(--border);margin-top:18px;background:var(--surface-high);}
table{width:100%;border-collapse:collapse;font-size:12px;font-family:'DM Mono',monospace;}
thead{position:sticky;top:0;background:var(--slate);z-index:10;}
th{padding:9px 12px;color:var(--muted);text-align:right;border-bottom:1px solid var(--border);font-family:'DM Sans',sans-serif;font-weight:600;font-size:11px;}
td{padding:7px 12px;text-align:right;border-bottom:1px solid rgba(51,65,85,0.22);color:#cbd5e1;}
.col-principal{color:var(--primary-light);}.col-interest{color:var(--accent);}

/* FOOTER */
.footer-note{margin-top:26px;padding:13px 17px;border-radius:10px;background:rgba(30,41,59,0.4);border:1px solid var(--border);font-size:12px;color:var(--muted);display:flex;align-items:center;gap:9px;}

/* NEWS SIDEBAR */
.news-sidebar{width:268px;flex-shrink:0;border-left:1px solid var(--border);background:var(--news-bg);display:flex;flex-direction:column;overflow-y:auto;max-height:calc(100vh - 64px);position:sticky;top:64px;}
.news-section{border-bottom:1px solid var(--border);}
.news-section-header{padding:11px 13px 7px;font-size:11px;font-weight:700;letter-spacing:0.08em;text-transform:uppercase;color:var(--text);display:flex;align-items:center;gap:7px;border-left:3px solid var(--primary);margin:11px 10px 3px;border-radius:0 4px 4px 0;}
.bank-card{margin:4px 9px;padding:10px 12px;background:var(--surface);border:1px solid var(--border);border-radius:9px;text-decoration:none;display:block;transition:all 0.15s;}
.bank-card:hover{border-color:var(--primary);transform:translateY(-1px);}
.bank-card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;}
.bank-name{font-size:13px;font-weight:700;color:var(--text);}
.bank-badge{font-size:9px;padding:2px 6px;border-radius:99px;background:var(--primary-dim);color:var(--primary-light);border:1px solid rgba(79,70,229,0.2);font-weight:600;letter-spacing:0.05em;}
.rate-row{display:flex;justify-content:space-between;align-items:center;padding:3px 0;border-bottom:1px solid rgba(51,65,85,0.13);}
.rate-row:last-child{border-bottom:none;}
.rate-label{font-size:11px;color:var(--muted);}
.rate-value{font-size:12px;font-weight:600;font-family:'DM Mono',monospace;color:var(--emerald-light);}
.bank-link{font-size:10px;color:var(--primary-light);margin-top:5px;display:block;}
.news-item{margin:4px 9px;padding:9px 11px;background:var(--surface);border:1px solid var(--border);border-radius:9px;text-decoration:none;display:block;transition:all 0.15s;}
.news-item:hover{border-color:var(--accent);transform:translateY(-1px);}
.news-tag{display:inline-block;font-size:9px;padding:2px 6px;border-radius:99px;font-weight:700;letter-spacing:0.06em;margin-bottom:4px;text-transform:uppercase;}
.tag-mortgage{background:rgba(79,70,229,0.2);color:var(--primary-light);}
.tag-vehicle{background:rgba(16,185,129,0.2);color:var(--emerald-light);}
.tag-personal{background:rgba(245,158,11,0.2);color:var(--accent);}
.news-headline{font-size:12px;font-weight:600;color:var(--text);line-height:1.4;margin-bottom:3px;}
.news-meta{font-size:10px;color:var(--muted);}
.news-source{color:var(--primary-light);font-weight:500;}
.rbf-box{margin:6px 9px 9px;padding:10px 12px;background:linear-gradient(135deg,rgba(79,70,229,0.12),rgba(16,185,129,0.08));border:1px solid rgba(79,70,229,0.22);border-radius:9px;}
.rbf-label{font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:0.06em;}
.rbf-rate{font-size:19px;font-weight:700;font-family:'DM Mono',monospace;color:var(--primary-light);}
.rbf-sub{font-size:11px;color:var(--muted);margin-top:2px;}
.milestone{background:var(--surface-high);border-radius:10px;padding:13px;border:1px solid var(--border);}
.milestone-year{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:3px;}
.milestone-val{font-size:18px;font-weight:700;font-family:'DM Mono',monospace;color:var(--emerald-light);}
.milestone-sub{font-size:11px;color:var(--muted);margin-top:2px;}

/* CALC PAGES */
.calc-page{display:none;animation:fadeIn 0.25s ease;}.calc-page.active{display:block;}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}

/* RATES PAGE */
.rates-page-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:8px;}
.rates-bank-card{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:18px;text-decoration:none;display:block;transition:all 0.2s;}
.rates-bank-card:hover{border-color:var(--primary);transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.15);}
.rates-bank-header{display:flex;align-items:center;gap:11px;margin-bottom:14px;padding-bottom:12px;border-bottom:1px solid var(--border);}
.rates-bank-logo{width:42px;height:42px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:white;flex-shrink:0;letter-spacing:0.02em;}
.rates-bank-logo.anz{background:linear-gradient(135deg,#005f9e,#0085c8);}
.rates-bank-logo.westpac{background:linear-gradient(135deg,#c7001a,#e8001e);}
.rates-bank-logo.bsp{background:linear-gradient(135deg,#004a8f,#0066cc);}
.rates-bank-logo.hfc{background:linear-gradient(135deg,#006644,#009966);}
.rates-bank-logo.fdb{background:linear-gradient(135deg,#7c3aed,#a855f7);}
.rates-bank-logo.mf{background:linear-gradient(135deg,#b45309,#d97706);}
.rates-bank-name{font-size:14px;font-weight:700;color:var(--text);line-height:1.2;}
.rates-bank-updated{font-size:10px;color:var(--muted);margin-top:2px;}
.rates-category-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--muted);margin:12px 0 6px;padding-top:8px;border-top:1px solid rgba(51,65,85,0.2);}
.rates-row{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid rgba(51,65,85,0.1);}
.rates-row:last-of-type{border-bottom:none;}
.rates-row span:first-child{font-size:12px;color:var(--muted);}
.rates-val{font-size:13px;font-weight:700;font-family:'DM Mono',monospace;color:var(--emerald-light);}
.rates-val.rates-high{color:#FCA5A5;}
.rates-val.rates-low{color:var(--emerald-light);}
.rates-val.rates-contact{color:var(--muted);font-size:11px;}
.rates-bank-link{font-size:11px;color:var(--primary-light);margin-top:12px;display:block;padding-top:10px;border-top:1px solid var(--border);}
.rates-news-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:20px;}
.rates-news-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:14px;text-decoration:none;display:block;transition:all 0.2s;}
.rates-news-card:hover{border-color:var(--accent);transform:translateY(-1px);}
.rates-news-headline{font-size:13px;font-weight:600;color:var(--text);line-height:1.5;margin:6px 0 6px;}
@media(max-width:1023px){.rates-page-grid{grid-template-columns:repeat(2,1fr);}.rates-news-grid{grid-template-columns:repeat(2,1fr);}}
@media(max-width:600px){.rates-page-grid{grid-template-columns:1fr;}.rates-news-grid{grid-template-columns:1fr;}}

/* EMAIL VERIFIED POPUP */
.email-popup-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.65);backdrop-filter:blur(6px);z-index:1000;display:none;align-items:center;justify-content:center;padding:20px;}
.email-popup-overlay.open{display:flex;animation:fadeIn 0.25s ease;}
.email-popup{background:var(--surface);border:1px solid rgba(16,185,129,0.35);border-radius:24px;padding:0;max-width:420px;width:100%;box-shadow:0 30px 80px rgba(0,0,0,0.5);overflow:hidden;text-align:center;}
.email-popup-top{background:linear-gradient(135deg,rgba(16,185,129,0.15),rgba(79,70,229,0.1));padding:36px 32px 28px;border-bottom:1px solid var(--border);}
.email-popup-emoji{font-size:56px;display:block;margin-bottom:14px;animation:bounce 0.6s ease;}
@keyframes bounce{0%,100%{transform:translateY(0);}40%{transform:translateY(-12px);}70%{transform:translateY(-5px);}}
.email-popup-title{font-size:22px;font-weight:800;color:var(--text);letter-spacing:-0.02em;margin-bottom:6px;}
.email-popup-email{font-size:13px;font-weight:600;color:var(--emerald-light);background:rgba(16,185,129,0.12);border:1px solid rgba(16,185,129,0.25);border-radius:99px;padding:4px 14px;display:inline-block;margin-bottom:10px;font-family:'DM Mono',monospace;}
.email-popup-desc{font-size:14px;color:var(--muted);line-height:1.6;}
.email-popup-bottom{padding:22px 32px 28px;}
.email-popup-steps{text-align:left;margin-bottom:20px;}
.email-popup-step{display:flex;align-items:flex-start;gap:11px;padding:9px 0;border-bottom:1px solid rgba(51,65,85,0.2);}
.email-popup-step:last-child{border-bottom:none;}
.step-num{width:24px;height:24px;border-radius:50%;background:var(--primary);color:white;font-size:12px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:1px;}
.step-text{font-size:13px;color:var(--text);line-height:1.4;}
.step-text small{color:var(--muted);font-size:11px;display:block;margin-top:2px;}
.email-popup-btn{width:100%;padding:13px;border-radius:11px;border:none;cursor:pointer;font-size:15px;font-weight:700;font-family:'DM Sans',sans-serif;background:linear-gradient(135deg,var(--primary),var(--primary-light));color:white;box-shadow:0 4px 15px rgba(79,70,229,0.35);transition:all 0.2s;}
.email-popup-btn:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(79,70,229,0.45);}
.email-popup-resend{margin-top:12px;font-size:12px;color:var(--muted);text-align:center;}
.email-popup-resend a{color:var(--primary-light);cursor:pointer;text-decoration:none;}
.email-popup-resend a:hover{text-decoration:underline;}

/* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

/* Large desktop (1400px+) ‚Äî wider sidebar */
@media(min-width:1400px){
  .sidebar{width:270px;}
  .calc-grid{grid-template-columns:420px 1fr;}
  .content{padding:32px;}
}

/* Standard desktop (1200px‚Äì1400px) ‚Äî news sidebar hides */
@media(max-width:1200px){
  .news-sidebar{display:none;}
}

/* Tablet landscape (1024px‚Äì1199px) */
@media(max-width:1199px){
  .calc-grid{grid-template-columns:1fr;}
  .sidebar{width:220px;}
  .brand-sub{display:none;}
}

/* Tablet portrait (768px‚Äì1023px) */
@media(max-width:1023px){
  .calc-grid{grid-template-columns:1fr;}
  .grid-3{grid-template-columns:1fr 1fr;}
  .compare-grid{grid-template-columns:1fr 1fr;}
  .sidebar{width:200px;}
  .nav-desc{display:none;}
  .content{padding:18px;}
  .stat-card.accent .stat-value{font-size:26px;}
  .live-badge{display:none;}
}

/* Mobile landscape / large phones (600px‚Äì767px) */
@media(max-width:767px){
  /* Auth */
  #auth-screen{align-items:flex-start;padding-top:20px;}
  .auth-card{margin:12px;padding:28px 20px;border-radius:16px;max-width:100%;}
  .auth-logo-name{font-size:18px;}

  /* Topbar */
  .topbar{padding:0 12px;height:56px;}
  .brand-name{font-size:15px;}
  .brand-sub{display:none;}
  .live-badge{display:none;}
  .user-email-small{display:none;}
  .icon-btn{width:34px;height:34px;font-size:15px;}

  /* App layout ‚Äî sidebar becomes bottom tab bar */
  .app-body{flex-direction:column-reverse;}
  .sidebar{
    width:100%;flex-direction:row;overflow-x:auto;
    padding:6px 8px;border-right:none;border-top:1px solid var(--border);
    gap:4px;position:sticky;bottom:0;z-index:50;
    background:var(--topbar-bg);backdrop-filter:blur(12px);
    min-height:60px;align-items:center;
  }
  .nav-item{
    flex-direction:column;align-items:center;justify-content:center;
    padding:6px 10px;width:auto;flex-shrink:0;min-width:56px;
    border-left:none;border-bottom:3px solid transparent;border-radius:8px;gap:3px;
  }
  .nav-item.active{border-left:none;border-bottom-color:var(--primary-light);}
  .nav-icon{width:26px;height:26px;font-size:14px;background:transparent;}
  .nav-item.active .nav-icon{background:transparent;}
  .nav-label{font-size:10px;font-weight:600;line-height:1;}
  .nav-desc,.nav-divider{display:none;}

  /* Content */
  .content{padding:14px;overflow-y:auto;}
  .page-title{font-size:20px;}
  .page-sub{font-size:12px;}
  .page-header{margin-bottom:16px;gap:10px;}
  .page-header-icon{font-size:22px;}

  /* Calc grid ‚Äî single column */
  .calc-grid{grid-template-columns:1fr;gap:14px;}
  .grid-2{grid-template-columns:1fr 1fr;gap:10px;}
  .grid-3{grid-template-columns:1fr 1fr;gap:8px;}
  .compare-grid{grid-template-columns:1fr;}

  /* Panels */
  .panel{padding:16px;}
  .stat-card{padding:12px 14px;}
  .stat-value{font-size:20px;}
  .stat-card.accent .stat-value{font-size:24px;}

  /* Inputs */
  .input-number{width:100px;font-size:13px;}
  .input-label{font-size:12px;}
  .save-bar{flex-wrap:wrap;gap:8px;}
  .save-bar input{min-width:0;flex:1;}

  /* Save bar label hide on small */
  .save-bar > span{display:none;}

  /* Compare selects */
  .compare-selector{flex-direction:column;}
  select{width:100%;}

  /* Saved card actions */
  .saved-card-actions{gap:5px;}
  .btn-sm{padding:5px 9px;font-size:11px;}

  /* Profile dropdown ‚Äî open upward on mobile */
  .profile-dropdown{top:auto;bottom:calc(100% + 8px);right:0;}

  /* Modals full-screen on mobile */
  .modal,.cpw-card,.email-popup{max-width:100%;border-radius:16px;}
  .email-popup-top{padding:26px 22px 20px;}
  .email-popup-bottom{padding:18px 22px 22px;}
  .email-popup-emoji{font-size:44px;}
  .email-popup-title{font-size:19px;}

  /* Footer note */
  .footer-note{font-size:11px;padding:10px 13px;}
}

/* Small phones (below 480px) */
@media(max-width:479px){
  .auth-card{margin:8px;padding:22px 16px;}
  .auth-logo-name{font-size:17px;}
  .auth-tab{font-size:13px;padding:8px;}
  .auth-btn{font-size:14px;padding:12px;}
  .grid-2{grid-template-columns:1fr;}
  .grid-3{grid-template-columns:1fr 1fr;}
  .stat-card.accent .stat-value{font-size:22px;}
  .topbar{height:52px;}
  .user-name{max-width:80px;font-size:12px;}
  .content{padding:10px;}
  .panel{padding:13px;}
  .page-title{font-size:18px;}
  .input-number{width:88px;}
  .nav-item{min-width:48px;padding:5px 7px;}
  .nav-label{font-size:9px;}
}
/* PWA INSTALL BANNER */
#pwa-banner{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(120px);z-index:300;background:linear-gradient(135deg,var(--primary),var(--primary-light));color:white;border-radius:16px;padding:14px 18px;display:flex;align-items:center;gap:12px;box-shadow:0 8px 32px rgba(79,70,229,0.45);max-width:340px;width:calc(100% - 32px);transition:transform 0.4s cubic-bezier(0.34,1.56,0.64,1);pointer-events:none;opacity:0;}
#pwa-banner.show{transform:translateX(-50%) translateY(0);pointer-events:all;opacity:1;}
.pwa-icon{font-size:28px;flex-shrink:0;}
.pwa-text{flex:1;}
.pwa-title{font-size:14px;font-weight:700;line-height:1.2;}
.pwa-sub{font-size:11px;opacity:0.85;margin-top:2px;}
.pwa-actions{display:flex;flex-direction:column;gap:5px;flex-shrink:0;}
.pwa-install-btn{padding:7px 14px;border-radius:8px;border:none;cursor:pointer;font-size:12px;font-weight:700;font-family:'DM Sans',sans-serif;background:white;color:var(--primary);white-space:nowrap;}
.pwa-dismiss{background:transparent;border:none;color:white;opacity:0.7;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;text-align:center;}
@media(max-width:767px){#pwa-banner{bottom:72px;}}

/* ADMIN PANEL */
#admin-panel{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);z-index:600;overflow-y:auto;padding:20px;}
#admin-panel.open{display:block;}
.admin-wrap{max-width:700px;margin:0 auto;}
.admin-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;padding:18px 22px;background:linear-gradient(135deg,rgba(79,70,229,0.2),rgba(16,185,129,0.1));border:1px solid var(--primary);border-radius:16px;}
.admin-title{font-size:20px;font-weight:800;color:var(--text);}
.admin-subtitle{font-size:12px;color:var(--muted);margin-top:2px;}
.admin-close{width:36px;height:36px;border-radius:9px;border:1px solid var(--border);background:var(--surface-high);color:var(--text);cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center;}
.admin-section{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px;margin-bottom:16px;}
.admin-section-title{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--muted);margin-bottom:16px;display:flex;align-items:center;gap:8px;padding-bottom:10px;border-bottom:1px solid var(--border);}
.admin-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.admin-field{display:flex;flex-direction:column;gap:6px;}
.admin-field.full{grid-column:1/-1;}
.admin-label{font-size:11px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;}
.admin-input{background:var(--input-bg);border:1px solid var(--border);color:var(--input-color);border-radius:8px;padding:9px 12px;font-size:14px;font-family:'DM Sans',sans-serif;outline:none;transition:border 0.2s;width:100%;}
.admin-input:focus{border-color:var(--primary-light);}
.admin-input.rate{font-family:'DM Mono',monospace;font-size:15px;}
.admin-bank-card{background:var(--surface-high);border:1px solid var(--border);border-radius:11px;padding:14px;margin-bottom:10px;}
.admin-bank-name{font-size:14px;font-weight:700;margin-bottom:12px;color:var(--text);display:flex;align-items:center;gap:8px;}
.admin-news-item{background:var(--surface-high);border:1px solid var(--border);border-radius:11px;padding:14px;margin-bottom:10px;position:relative;}
.admin-news-remove{position:absolute;top:10px;right:10px;background:rgba(239,68,68,0.15);border:none;color:#FCA5A5;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:12px;font-family:'DM Sans',sans-serif;}
.admin-add-btn{width:100%;padding:10px;border-radius:9px;border:2px dashed var(--border);background:transparent;color:var(--muted);font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all 0.2s;margin-top:4px;}
.admin-add-btn:hover{border-color:var(--primary);color:var(--primary-light);}
.admin-save-btn{width:100%;padding:14px;border-radius:11px;border:none;cursor:pointer;font-size:15px;font-weight:700;font-family:'DM Sans',sans-serif;background:linear-gradient(135deg,var(--primary),var(--primary-light));color:white;box-shadow:0 4px 15px rgba(79,70,229,0.35);transition:all 0.2s;margin-top:4px;}
.admin-save-btn:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(79,70,229,0.45);}
.admin-save-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;}
.admin-msg{padding:11px 14px;border-radius:9px;font-size:13px;margin-top:10px;display:none;}
.admin-msg.success{background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);color:var(--emerald-light);}
.admin-msg.error{background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:#FCA5A5;}
.admin-login{background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:32px;max-width:360px;margin:60px auto;}
@media(max-width:600px){.admin-grid{grid-template-columns:1fr;}.admin-field.full{grid-column:1;}}
</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê AUTH SCREEN ‚ïê‚ïê‚ïê -->
<div id="auth-screen">
  <div class="auth-card">
    <div class="auth-logo">
      <div class="auth-logo-icon">üí∞</div>
      <div><div class="auth-logo-name">Finance Calculator</div><div class="auth-logo-sub">Fiji Financial Suite</div></div>
    </div>
    <div class="auth-tabs">
      <button class="auth-tab active" onclick="authTab('login')">Sign In</button>
      <button class="auth-tab" onclick="authTab('register')">Create Account</button>
    </div>
    <!-- LOGIN -->
    <div id="auth-login" class="auth-panel active">
      <div class="auth-field"><label class="auth-label">Email Address</label><input class="auth-input" id="login-email" type="email" placeholder="you@example.com" autocomplete="email"/></div>
      <div class="auth-field"><label class="auth-label">Password</label><input class="auth-input" id="login-password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" onkeydown="if(event.key==='Enter')doLogin()"/></div>
      <button class="auth-btn" id="login-btn" onclick="doLogin()">Sign In ‚Üí</button>
      <div class="auth-msg" id="login-msg"></div>
      <div class="auth-divider">or</div>
      <div style="text-align:center;font-size:13px;color:var(--muted)">Forgot password? <a href="#" onclick="doReset()" style="color:var(--primary-light)">Reset via email</a></div>
    </div>
    <!-- REGISTER -->
    <div id="auth-register" class="auth-panel">
      <div class="auth-field"><label class="auth-label">Full Name / Username</label><input class="auth-input" id="reg-name" type="text" placeholder="e.g. Sai Kumar" autocomplete="name"/></div>
      <div class="auth-field"><label class="auth-label">Email Address</label><input class="auth-input" id="reg-email" type="email" placeholder="you@example.com" autocomplete="email"/></div>
      <div class="auth-field"><label class="auth-label">Password <span style="color:var(--muted);font-size:10px;text-transform:none">(min. 8 chars)</span></label><input class="auth-input" id="reg-password" type="password" placeholder="Min. 8 characters" autocomplete="new-password"/></div>
      <div class="auth-field"><label class="auth-label">Confirm Password</label><input class="auth-input" id="reg-confirm" type="password" placeholder="Repeat password" autocomplete="new-password"/></div>
      <button class="auth-btn" id="reg-btn" onclick="doRegister()">Create Account & Verify Email ‚Üí</button>
      <div class="auth-msg" id="reg-msg"></div>
    </div>
    <div class="auth-footer">By signing in you agree to our terms &amp; privacy policy.<br>Data stored securely via Supabase.</div>
  </div>
</div>

<!-- EMAIL VERIFICATION POPUP -->
<div class="email-popup-overlay" id="email-popup-overlay">
  <div class="email-popup">
    <div class="email-popup-top">
      <span class="email-popup-emoji">üì¨</span>
      <div class="email-popup-title">Verify Your Email</div>
      <div class="email-popup-email" id="popup-email-display">you@example.com</div>
      <div class="email-popup-desc">We've sent a verification link to your email address. Please check your inbox and follow the steps below.</div>
    </div>
    <div class="email-popup-bottom">
      <div class="email-popup-steps">
        <div class="email-popup-step">
          <div class="step-num">1</div>
          <div class="step-text">Open the email from <strong>Supabase Auth</strong><small>Subject: "Confirm your signup"</small></div>
        </div>
        <div class="email-popup-step">
          <div class="step-num">2</div>
          <div class="step-text">Click <strong>"Confirm your mail"</strong> in the email<small>This activates your account</small></div>
        </div>
        <div class="email-popup-step">
          <div class="step-num">3</div>
          <div class="step-text">Come back and <strong>Sign In</strong> with your password<small>You'll be logged in automatically</small></div>
        </div>
      </div>
      <button class="email-popup-btn" onclick="closeEmailPopup()">Got it ‚Äî I'll check my email ‚úì</button>
      <div class="email-popup-resend">Didn't receive it? Check spam or <a onclick="resendVerification()">resend email</a></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê APP SCREEN ‚ïê‚ïê‚ïê -->
<div id="app-screen">
  <div class="topbar">
    <div class="topbar-brand">
      <div class="brand-icon">üí∞</div>
      <div><div class="brand-name">Finance Calculator</div><div class="brand-sub">Fiji Financial Suite</div></div>
    </div>
    <div class="topbar-right">
      <button class="icon-btn" id="theme-btn" onclick="toggleTheme()" title="Toggle theme">üåô</button>
      <button class="icon-btn" id="admin-btn" onclick="openAdmin()" title="Admin panel" style="display:none">‚öôÔ∏è</button>

      <!-- Profile Dropdown -->
      <div class="profile-wrap" id="profile-wrap">
        <div class="user-chip" id="user-chip" onclick="toggleProfileMenu()">
          <div class="user-avatar" id="user-avatar">?</div>
          <div class="user-info">
            <div class="user-name" id="user-name-display">User</div>
            <div class="user-email-small" id="user-email-display">‚Äî</div>
          </div>
          <span class="user-chevron">‚ñº</span>
        </div>
        <div class="profile-dropdown" id="profile-dropdown">
          <div class="profile-header">
            <div class="profile-header-avatar" id="drop-avatar">?</div>
            <div>
              <div class="profile-header-name" id="drop-name">User</div>
              <div class="profile-header-email" id="drop-email">‚Äî</div>
            </div>
          </div>
          <div class="profile-menu">
            <button class="profile-menu-item" onclick="openChangePassword()">
              <div class="profile-menu-icon blue">üîë</div>
              <div class="profile-menu-label">
                <span>Change Password</span>
                <span class="profile-menu-desc">Update your login password</span>
              </div>
            </button>
            <button class="profile-menu-item" onclick="switchTab('saved', document.querySelectorAll('.nav-item')[4]);closeProfileMenu()">
              <div class="profile-menu-icon blue">üíæ</div>
              <div class="profile-menu-label">
                <span>My Saved Calculations</span>
                <span class="profile-menu-desc">View all saved scenarios</span>
              </div>
            </button>
            <div class="profile-menu-divider"></div>
            <button class="profile-menu-item danger" onclick="doSignOut()">
              <div class="profile-menu-icon red">üö™</div>
              <div class="profile-menu-label">
                <span>Sign Out</span>
                <span class="profile-menu-desc">End your current session</span>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="app-body">
    <!-- Sidebar Nav -->
    <nav class="sidebar" id="main-sidebar">
      <button class="sidebar-toggle" id="sidebar-toggle" onclick="toggleSidebar()" title="Collapse sidebar">‚Äπ</button>
      <button class="nav-item active" onclick="switchTab('mortgage',this)"><div class="nav-icon">üè†</div><div><div class="nav-label">Mortgage</div><div class="nav-desc">Home Loan</div></div></button>
      <button class="nav-item" onclick="switchTab('vehicle',this)"><div class="nav-icon">üöó</div><div><div class="nav-label">Vehicle</div><div class="nav-desc">Auto Financing</div></div></button>
      <button class="nav-item" onclick="switchTab('personal',this)"><div class="nav-icon">üí≥</div><div><div class="nav-label">Personal Loan</div><div class="nav-desc">General Amortized</div></div></button>
      <button class="nav-item" onclick="switchTab('savings',this)"><div class="nav-icon">üìà</div><div><div class="nav-label">Savings & Invest</div><div class="nav-desc">Compound Growth</div></div></button>
      <div class="nav-divider"></div>
      <button class="nav-item" onclick="switchTab('saved',this)"><div class="nav-icon">üíæ</div><div><div class="nav-label">My Saved</div><div class="nav-desc">Calculations</div></div></button>
      <button class="nav-item" onclick="switchTab('compare',this)"><div class="nav-icon">‚öñÔ∏è</div><div><div class="nav-label">Compare</div><div class="nav-desc">Side by Side</div></div></button>
      <button class="nav-item" onclick="switchTab('rates',this)"><div class="nav-icon">üè¶</div><div><div class="nav-label">Rates &amp; News</div><div class="nav-desc">Fiji Bank Rates</div></div></button>
    </nav>

    <!-- Main Content -->
    <main class="content">

      <!-- MORTGAGE -->
      <div id="page-mortgage" class="calc-page active">
        <div class="page-header"><span class="page-header-icon">üè†</span><div><div class="page-title">Mortgage Calculator</div><div class="page-sub">Home Purchase Loan ‚Äî real-time results in FJD</div></div></div>
        <div class="save-bar"><span style="font-size:13px;color:var(--muted);white-space:nowrap">üíæ Save:</span><input type="text" id="m-save-label" placeholder="Name this calc (e.g. Dream Home 2025)"/><button class="btn btn-primary btn-sm" onclick="saveCalc('mortgage')">Save</button></div>
        <div class="calc-grid">
          <div class="panel">
            <div class="section-title">Loan Parameters</div>
            <div class="input-group"><div class="input-row"><span class="input-label">Home Price</span><input class="input-number" type="number" id="m-price" value="450000" oninput="syncSlider('m-price','ms-price');calcMortgage()"/></div><input type="range" id="ms-price" min="100000" max="2000000" step="5000" value="450000" oninput="syncInput('ms-price','m-price');calcMortgage()"/><div class="range-hints"><span>$100k</span><span>$2M</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Down Payment %</span><input class="input-number" type="number" id="m-down" value="20" oninput="syncSlider('m-down','ms-down');calcMortgage()"/></div><input type="range" id="ms-down" min="3" max="50" step="0.5" value="20" oninput="syncInput('ms-down','m-down');calcMortgage()"/><div class="range-hints"><span>3%</span><span>50%</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Interest Rate %</span><input class="input-number" type="number" id="m-rate" value="6.49" step="0.05" oninput="syncSlider('m-rate','ms-rate');calcMortgage()"/></div><input type="range" id="ms-rate" min="2" max="15" step="0.05" value="6.49" oninput="syncInput('ms-rate','m-rate');calcMortgage()"/><div class="range-hints"><span>2%</span><span>15%</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Loan Term (years)</span><input class="input-number" type="number" id="m-term" value="30" oninput="syncSlider('m-term','ms-term');calcMortgage()"/></div><input type="range" id="ms-term" min="5" max="30" step="5" value="30" oninput="syncInput('ms-term','m-term');calcMortgage()"/><div class="range-hints"><span>5 yrs</span><span>30 yrs</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Annual Property Tax</span><input class="input-number" type="number" id="m-tax" value="4500" oninput="syncSlider('m-tax','ms-tax');calcMortgage()"/></div><input type="range" id="ms-tax" min="0" max="30000" step="100" value="4500" oninput="syncInput('ms-tax','m-tax');calcMortgage()"/><div class="range-hints"><span>$0</span><span>$30k</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Annual Insurance</span><input class="input-number" type="number" id="m-ins" value="1800" oninput="syncSlider('m-ins','ms-ins');calcMortgage()"/></div><input type="range" id="ms-ins" min="0" max="10000" step="100" value="1800" oninput="syncInput('ms-ins','m-ins');calcMortgage()"/><div class="range-hints"><span>$0</span><span>$10k</span></div></div>
          </div>
          <div class="grid-col">
            <div class="panel analysis-panel"><div class="section-title">‚ú® Smart Analysis</div><div class="analysis-text" id="m-analysis">Adjust sliders to see analysis.</div></div>
            <div class="panel">
              <div class="section-title">Monthly Breakdown</div>
              <div class="stat-card accent" style="margin-bottom:13px"><div class="stat-label">Principal & Interest Payment</div><div class="stat-value" id="m-out-pi">‚Äî</div></div>
              <div class="grid-2" style="gap:10px"><div class="stat-card"><div class="stat-label">Total Monthly</div><div class="stat-value" id="m-out-total">‚Äî</div></div><div class="stat-card"><div class="stat-label">Loan Amount</div><div class="stat-value" id="m-out-loan">‚Äî</div></div><div class="stat-card"><div class="stat-label">Total Interest</div><div class="stat-value" id="m-out-interest">‚Äî</div></div><div class="stat-card"><div class="stat-label">Total Cost</div><div class="stat-value" id="m-out-cost">‚Äî</div></div></div>
            </div>
            <div class="panel"><div class="section-title">Annual Amortization</div><div class="chart-wrap"><canvas id="chart-mortgage" height="190"></canvas></div></div>
          </div>
        </div>
        <div class="footer-note">‚ÑπÔ∏è Rate pre-filled from ANZ Fiji (Dec 2025). Verify with your bank before committing. All amounts FJD.</div>
      </div>

      <!-- VEHICLE -->
      <div id="page-vehicle" class="calc-page">
        <div class="page-header"><span class="page-header-icon">üöó</span><div><div class="page-title">Vehicle Loan Calculator</div><div class="page-sub">Auto Financing ‚Äî real-time results in FJD</div></div></div>
        <div class="save-bar"><span style="font-size:13px;color:var(--muted);white-space:nowrap">üíæ Save:</span><input type="text" id="v-save-label" placeholder="Name this calc (e.g. Toyota Hilux 2025)"/><button class="btn btn-primary btn-sm" onclick="saveCalc('vehicle')">Save</button></div>
        <div class="calc-grid">
          <div class="panel">
            <div class="section-title">Vehicle Details</div>
            <div class="input-group"><div class="input-row"><span class="input-label">Vehicle Price</span><input class="input-number" type="number" id="v-price" value="35000" oninput="syncSlider('v-price','vs-price');calcVehicle()"/></div><input type="range" id="vs-price" min="5000" max="200000" step="500" value="35000" oninput="syncInput('vs-price','v-price');calcVehicle()"/><div class="range-hints"><span>$5k</span><span>$200k</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Trade-in Value</span><input class="input-number" type="number" id="v-tradein" value="5000" oninput="syncSlider('v-tradein','vs-tradein');calcVehicle()"/></div><input type="range" id="vs-tradein" min="0" max="50000" step="500" value="5000" oninput="syncInput('vs-tradein','v-tradein');calcVehicle()"/><div class="range-hints"><span>$0</span><span>$50k</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Down Payment</span><input class="input-number" type="number" id="v-down" value="3000" oninput="syncSlider('v-down','vs-down');calcVehicle()"/></div><input type="range" id="vs-down" min="0" max="50000" step="500" value="3000" oninput="syncInput('vs-down','v-down');calcVehicle()"/><div class="range-hints"><span>$0</span><span>$50k</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Sales Tax %</span><input class="input-number" type="number" id="v-tax" value="9" step="0.25" oninput="syncSlider('v-tax','vs-tax');calcVehicle()"/></div><input type="range" id="vs-tax" min="0" max="20" step="0.25" value="9" oninput="syncInput('vs-tax','v-tax');calcVehicle()"/><div class="range-hints"><span>0%</span><span>20%</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Interest Rate %</span><input class="input-number" type="number" id="v-rate" value="8.45" step="0.1" oninput="syncSlider('v-rate','vs-rate');calcVehicle()"/></div><input type="range" id="vs-rate" min="1" max="25" step="0.1" value="8.45" oninput="syncInput('vs-rate','v-rate');calcVehicle()"/><div class="range-hints"><span>1%</span><span>25%</span></div></div>
            <div class="input-group"><div class="input-row"><span class="input-label">Loan Term (months)</span><input class="input-number" type="number" id="v-term" value="60" oninput="syncSlider('v-term','vs-term');calcVehicle()"/></div><input type="range" id="vs-term" min="12" max="84" step="12" value="60" oninput="syncInput('vs-term','v-term');calcVehicle()"/><div class="range-hints"><span>12 mo</span><span>84 mo</span></div></div>
          </div>
          <div class="grid-col">
            <div class="panel analysis-panel"><div class="section-title">‚ú® Smart Analysis</div><div class="analysis-text" id="v-analysis">Adjust sliders to see analysis.</div></div>
            <div class="panel">
              <div class="section-title">Summary</div>
              <div class="stat-card accent" style="margin-bottom:11px"><div class="stat-label">Monthly Payment</div><div class="stat-value" id="v-out-monthly">‚Äî</div></div>
              <div class="grid-3"><div class="stat-card"><div class="stat-label">Loan Amount</div><div class="stat-value" id="v-out-loan">‚Äî</div></div><div class="stat-card"><div class="stat-label">Sales Tax</div><div class="stat-value" id="v-out-tax">‚Äî</div></div><div class="stat-card"><div class="stat-label">Total Interest</div><div class="stat-value" id="v-out-interest">‚Äî</div></div></div>
            </div>
            <div class="panel"><div class="section-title">Loan Balance Over Time</div><div class="chart-wrap"><canvas id="chart-vehicle" height="190"></canvas></div></div>
          </div>
        </div>
        <div class="footer-note">‚ÑπÔ∏è Rate pre-filled from ANZ Fiji car loan (Dec 2025). Fiji VAT is 15% ‚Äî adjust to your actual tax. All amounts FJD.</div>
      </div>

      <!-- PERSONAL -->
      <div id="page-personal" class="calc-page">
        <div class="page-header"><span class="page-header-icon">üí≥</span><div><div class="page-title">Personal Loan Calculator</div><div class="page-sub">General Amortized Loan ‚Äî real-time results in FJD</div></div></div>
        <div class="save-bar"><span style="font-size:13px;color:var(--muted);white-space:nowrap">üíæ Save:</span><input type="text" id="p-save-label" placeholder="Name this calc (e.g. Home Renovation)"/><button class="btn btn-primary btn-sm" onclick="saveCalc('personal')">Save</button></div>
        <div class="calc-grid">
          <div class="grid-col">
            <div class="panel">
              <div class="section-title">Loan Parameters</div>
              <div class="input-group"><div class="input-row"><span class="input-label">Loan Amount</span><input class="input-number" type="number" id="p-amount" value="15000" oninput="syncSlider('p-amount','ps-amount');calcPersonal()"/></div><input type="range" id="ps-amount" min="1000" max="100000" step="500" value="15000" oninput="syncInput('ps-amount','p-amount');calcPersonal()"/><div class="range-hints"><span>$1k</span><span>$100k</span></div></div>
              <div class="input-group"><div class="input-row"><span class="input-label">Annual Interest Rate %</span><input class="input-number" type="number" id="p-rate" value="10.5" step="0.25" oninput="syncSlider('p-rate','ps-rate');calcPersonal()"/></div><input type="range" id="ps-rate" min="1" max="36" step="0.25" value="10.5" oninput="syncInput('ps-rate','p-rate');calcPersonal()"/><div class="range-hints"><span>1%</span><span>36%</span></div></div>
              <div class="input-group"><div class="input-row"><span class="input-label">Loan Term (months)</span><input class="input-number" type="number" id="p-term" value="36" oninput="syncSlider('p-term','ps-term');calcPersonal()"/></div><input type="range" id="ps-term" min="6" max="84" step="6" value="36" oninput="syncInput('ps-term','p-term');calcPersonal()"/><div class="range-hints"><span>6 mo</span><span>84 mo</span></div></div>
            </div>
            <div class="panel">
              <div class="section-title">Results</div>
              <div class="stat-card accent" style="margin-bottom:11px"><div class="stat-label">Monthly Payment</div><div class="stat-value" id="p-out-monthly">‚Äî</div></div>
              <div class="grid-2" style="gap:11px;margin-bottom:13px"><div class="stat-card"><div class="stat-label">Total Interest</div><div class="stat-value" id="p-out-interest">‚Äî</div></div><div class="stat-card"><div class="stat-label">Total Paid</div><div class="stat-value" id="p-out-total">‚Äî</div></div></div>
              <div style="padding:12px;background:var(--slate);border-radius:9px;border:1px solid var(--border)"><div style="color:var(--muted);font-size:12px;margin-bottom:5px">Interest as % of Loan</div><div class="progress-bar-wrap"><div class="progress-bar-fill" id="p-out-bar" style="width:0%"></div></div><div style="color:var(--primary-light);font-size:13px;margin-top:4px;font-family:'DM Mono',monospace" id="p-out-pct">0%</div></div>
            </div>
            <div class="panel analysis-panel"><div class="section-title">‚ú® Smart Analysis</div><div class="analysis-text" id="p-analysis">Adjust sliders to see analysis.</div></div>
          </div>
          <div class="panel">
            <div class="section-title">Monthly Amortization</div>
            <div class="chart-wrap"><canvas id="chart-personal" height="210"></canvas></div>
            <div class="amort-table-wrap"><table><thead><tr><th>Mo</th><th>Payment</th><th>Principal</th><th>Interest</th><th>Balance</th></tr></thead><tbody id="p-table"></tbody></table></div>
          </div>
        </div>
        <div class="footer-note">‚ÑπÔ∏è Rate pre-filled from ANZ Fiji secured personal loan (Dec 2025). All amounts FJD.</div>
      </div>

      <!-- SAVINGS -->
      <div id="page-savings" class="calc-page">
        <div class="page-header"><span class="page-header-icon">üìà</span><div><div class="page-title">Savings & Investment Calculator</div><div class="page-sub">Compound Growth ‚Äî real-time projection in FJD</div></div></div>
        <div class="save-bar"><span style="font-size:13px;color:var(--muted);white-space:nowrap">üíæ Save:</span><input type="text" id="s-save-label" placeholder="Name this scenario (e.g. Retirement Fund 2045)"/><button class="btn btn-primary btn-sm" onclick="saveCalc('savings')">Save</button></div>
        <div class="calc-grid">
          <div class="grid-col">
            <div class="panel">
              <div class="section-title">Investment Parameters</div>
              <div class="input-group"><div class="input-row"><span class="input-label">Initial Deposit</span><input class="input-number" type="number" id="s-initial" value="10000" oninput="syncSlider('s-initial','ss-initial');calcSavings()"/></div><input type="range" id="ss-initial" min="0" max="500000" step="1000" value="10000" oninput="syncInput('ss-initial','s-initial');calcSavings()"/><div class="range-hints"><span>$0</span><span>$500k</span></div></div>
              <div class="input-group"><div class="input-row"><span class="input-label">Monthly Contribution</span><input class="input-number" type="number" id="s-monthly" value="500" oninput="syncSlider('s-monthly','ss-monthly');calcSavings()"/></div><input type="range" id="ss-monthly" min="0" max="10000" step="50" value="500" oninput="syncInput('ss-monthly','s-monthly');calcSavings()"/><div class="range-hints"><span>$0</span><span>$10k</span></div></div>
              <div class="input-group"><div class="input-row"><span class="input-label">Annual Return Rate %</span><input class="input-number" type="number" id="s-rate" value="8" step="0.25" oninput="syncSlider('s-rate','ss-rate');calcSavings()"/></div><input type="range" id="ss-rate" min="1" max="20" step="0.25" value="8" oninput="syncInput('ss-rate','s-rate');calcSavings()"/><div class="range-hints"><span>1%</span><span>20%</span></div></div>
              <div class="input-group"><div class="input-row"><span class="input-label">Time Horizon (years)</span><input class="input-number" type="number" id="s-years" value="20" oninput="syncSlider('s-years','ss-years');calcSavings()"/></div><input type="range" id="ss-years" min="1" max="50" step="1" value="20" oninput="syncInput('ss-years','s-years');calcSavings()"/><div class="range-hints"><span>1 yr</span><span>50 yrs</span></div></div>
              <div><div class="input-label" style="margin-bottom:6px">Compound Frequency</div><div class="toggle-group"><button class="toggle-btn active" id="freq-monthly" onclick="setFreq('monthly')">Monthly</button><button class="toggle-btn" id="freq-annually" onclick="setFreq('annually')">Annually</button></div></div>
            </div>
            <div class="panel analysis-panel"><div class="section-title">‚ú® Smart Analysis</div><div class="analysis-text" id="s-analysis">Adjust sliders to see analysis.</div></div>
            <div class="panel">
              <div class="section-title">Outcome</div>
              <div class="stat-card accent" style="margin-bottom:11px"><div class="stat-label">Final Portfolio Value</div><div class="stat-value" id="s-out-final">‚Äî</div></div>
              <div class="grid-2" style="gap:11px;margin-bottom:13px"><div class="stat-card"><div class="stat-label">Total Invested</div><div class="stat-value" id="s-out-contrib">‚Äî</div></div><div class="stat-card"><div class="stat-label">Total Growth</div><div class="stat-value" id="s-out-growth" style="color:var(--emerald-light)">‚Äî</div></div></div>
              <div id="s-milestones" class="grid-3" style="gap:9px"></div>
            </div>
          </div>
          <div class="panel"><div class="section-title">Wealth Growth Projection</div><div class="chart-wrap"><canvas id="chart-savings" height="330"></canvas></div></div>
        </div>
        <div class="footer-note">‚ÑπÔ∏è Illustrative only. Past performance is not indicative of future returns. All amounts FJD.</div>
      </div>

      <!-- SAVED -->
      <div id="page-saved" class="calc-page">
        <div class="page-header"><span class="page-header-icon">üíæ</span><div><div class="page-title">My Saved Calculations</div><div class="page-sub">All your saved scenarios ‚Äî load, compare, share or export to PDF</div></div></div>
        <div style="display:flex;gap:9px;margin-bottom:18px;flex-wrap:wrap;align-items:center">
          <button class="btn btn-outline" onclick="loadSaved()">üîÑ Refresh</button>
          <div style="display:flex;gap:6px;flex-wrap:wrap" id="filter-btns">
            <button class="btn btn-outline btn-sm" style="border-color:var(--primary)" onclick="filterSaved('all',this)">All</button>
            <button class="btn btn-outline btn-sm" onclick="filterSaved('mortgage',this)">üè† Mortgage</button>
            <button class="btn btn-outline btn-sm" onclick="filterSaved('vehicle',this)">üöó Vehicle</button>
            <button class="btn btn-outline btn-sm" onclick="filterSaved('personal',this)">üí≥ Personal</button>
            <button class="btn btn-outline btn-sm" onclick="filterSaved('savings',this)">üìà Savings</button>
          </div>
        </div>
        <div id="saved-list-container"><div style="text-align:center;color:var(--muted);padding:60px 20px;font-size:14px">Loading your saved calculations...</div></div>
      </div>

      <!-- COMPARE -->
      <div id="page-compare" class="calc-page">
        <div class="page-header"><span class="page-header-icon">‚öñÔ∏è</span><div><div class="page-title">Compare Scenarios</div><div class="page-sub">Select two saved calculations to compare side by side</div></div></div>
        <div class="compare-selector">
          <select id="compare-a"><option value="">‚Äî Select Scenario A ‚Äî</option></select>
          <select id="compare-b"><option value="">‚Äî Select Scenario B ‚Äî</option></select>
          <button class="btn btn-primary" onclick="runCompare()">‚öñÔ∏è Compare</button>
          <button class="btn btn-outline" onclick="exportComparePDF()">üìÑ Export PDF</button>
        </div>
        <div id="compare-output"><div class="compare-empty">Select two saved calculations above and click Compare.</div></div>
      </div>

      <!-- RATES & NEWS PAGE -->
      <div id="page-rates" class="calc-page">
        <div class="page-header"><span class="page-header-icon">üè¶</span><div><div class="page-title">Fiji Bank Rates & News</div><div class="page-sub">Current lending rates from major Fiji banks ‚Äî updated 2025/2026</div></div></div>

        <!-- RBF Rate Banner -->
        <div style="background:linear-gradient(135deg,rgba(79,70,229,0.15),rgba(16,185,129,0.1));border:1px solid rgba(79,70,229,0.25);border-radius:16px;padding:20px 24px;margin-bottom:22px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
          <div>
            <div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:0.07em;font-weight:700;margin-bottom:4px">üè¶ Reserve Bank of Fiji ‚Äî Base Lending Rate</div>
            <div style="font-size:38px;font-weight:800;font-family:'DM Mono',monospace;color:var(--primary-light);letter-spacing:-0.02em">1.67%</div>
            <div style="font-size:13px;color:var(--muted);margin-top:2px">p.a. ‚Äî Q1 2025</div>
          </div>
          <div style="font-size:13px;color:var(--muted);max-width:260px;line-height:1.6">The RBF base rate influences all lending rates in Fiji. Lower base rate = cheaper loans across banks.</div>
        </div>

        <!-- Bank Rate Cards Grid -->
        <div class="section-title">üèõÔ∏è Local Bank Lending Rates</div>
        <div class="rates-page-grid">

          <a class="rates-bank-card" href="https://www.anz.com/fiji/en/interest-rates/" target="_blank">
            <div class="rates-bank-header"><div class="rates-bank-logo anz">ANZ</div><div><div class="rates-bank-name">ANZ Fiji</div><div class="rates-bank-updated">Updated Dec 2025</div></div><span class="bank-badge">CURRENT</span></div>
            <div class="rates-category-label">üè† Home Loans</div>
            <div class="rates-row"><span>Variable Rate</span><span class="rates-val">6.49%</span></div>
            <div class="rates-row"><span>1yr Fixed</span><span class="rates-val">3.95%</span></div>
            <div class="rates-row"><span>2yr Fixed</span><span class="rates-val">4.95%</span></div>
            <div class="rates-category-label">üöó Vehicle Loans</div>
            <div class="rates-row"><span>Car Loan</span><span class="rates-val">8.45%</span></div>
            <div class="rates-category-label">üí≥ Personal Loans</div>
            <div class="rates-row"><span>Secured</span><span class="rates-val">10.50%</span></div>
            <div class="rates-row"><span>Unsecured</span><span class="rates-val rates-high">16.50%</span></div>
            <div class="rates-bank-link">Visit anz.com/fiji ‚Üí</div>
          </a>

          <a class="rates-bank-card" href="https://www.westpac.com.fj/" target="_blank">
            <div class="rates-bank-header"><div class="rates-bank-logo westpac">WBC</div><div><div class="rates-bank-name">Westpac Fiji</div><div class="rates-bank-updated">Updated Jan 2026</div></div><span class="bank-badge">CURRENT</span></div>
            <div class="rates-category-label">üè† Home Loans</div>
            <div class="rates-row"><span>Variable Rate</span><span class="rates-val">7.49%</span></div>
            <div class="rates-row"><span>1yr Fixed</span><span class="rates-val">4.75%</span></div>
            <div class="rates-row"><span>2yr Fixed</span><span class="rates-val">5.45%</span></div>
            <div class="rates-category-label">üöó Vehicle Loans</div>
            <div class="rates-row"><span>1yr Fixed</span><span class="rates-val">4.75%</span></div>
            <div class="rates-row"><span>Variable</span><span class="rates-val">6.49%</span></div>
            <div class="rates-category-label">üí≥ Personal Loans</div>
            <div class="rates-row"><span>Secured</span><span class="rates-val">10.45%</span></div>
            <div class="rates-row"><span>Unsecured</span><span class="rates-val rates-high">16.50%</span></div>
            <div class="rates-bank-link">Visit westpac.com.fj ‚Üí</div>
          </a>

          <a class="rates-bank-card" href="https://www.bsp.com.fj/help/indicated-lending-rates/" target="_blank">
            <div class="rates-bank-header"><div class="rates-bank-logo bsp">BSP</div><div><div class="rates-bank-name">BSP Fiji</div><div class="rates-bank-updated">Updated 2025</div></div><span class="bank-badge">CURRENT</span></div>
            <div class="rates-category-label">üè† Home Loans</div>
            <div class="rates-row"><span>1yr Fixed</span><span class="rates-val">4.10%</span></div>
            <div class="rates-row"><span>2yr Fixed</span><span class="rates-val">4.90%</span></div>
            <div class="rates-category-label">üöó Vehicle Loans</div>
            <div class="rates-row"><span>Motor Vehicle</span><span class="rates-val rates-contact">Contact BSP</span></div>
            <div class="rates-category-label">üí≥ Personal Loans</div>
            <div class="rates-row"><span>Personal Loan</span><span class="rates-val rates-contact">Contact BSP</span></div>
            <div class="rates-bank-link">Visit bsp.com.fj ‚Üí</div>
          </a>

          <a class="rates-bank-card" href="https://www.hfc.com.fj/" target="_blank">
            <div class="rates-bank-header"><div class="rates-bank-logo hfc">HFC</div><div><div class="rates-bank-name">HFC Bank</div><div class="rates-bank-updated">Updated 2025</div></div></div>
            <div class="rates-category-label">üè† Home Loans</div>
            <div class="rates-row"><span>Dream Home Package</span><span class="rates-val rates-contact">Competitive</span></div>
            <div class="rates-category-label">üöó Vehicle Loans</div>
            <div class="rates-row"><span>Motor Vehicle</span><span class="rates-val rates-contact">Contact HFC</span></div>
            <div class="rates-category-label">üí≥ Personal Loans</div>
            <div class="rates-row"><span>Personal Loan</span><span class="rates-val rates-contact">Contact HFC</span></div>
            <div class="rates-bank-link">Visit hfc.com.fj ‚Üí</div>
          </a>

          <a class="rates-bank-card" href="https://www.fdb.com.fj/" target="_blank">
            <div class="rates-bank-header"><div class="rates-bank-logo fdb">FDB</div><div><div class="rates-bank-name">Fiji Development Bank</div><div class="rates-bank-updated">Updated 2025</div></div></div>
            <div class="rates-category-label">üè† Home Loans</div>
            <div class="rates-row"><span>Choice Home Loan</span><span class="rates-val rates-low">from 3.99%</span></div>
            <div class="rates-row"><span>No internal fees</span><span class="rates-val rates-low">First 6 months</span></div>
            <div class="rates-category-label">üë§ Special Focus</div>
            <div class="rates-row"><span>Youth / Women</span><span class="rates-val rates-low">‚úì Priority</span></div>
            <div class="rates-row"><span>Rural Communities</span><span class="rates-val rates-low">‚úì Priority</span></div>
            <div class="rates-bank-link">Visit fdb.com.fj ‚Üí</div>
          </a>

          <a class="rates-bank-card" href="https://www.merchantfinancefiji.com/" target="_blank">
            <div class="rates-bank-header"><div class="rates-bank-logo mf">MF</div><div><div class="rates-bank-name">Merchant Finance</div><div class="rates-bank-updated">Updated 2025</div></div></div>
            <div class="rates-category-label">üè† Home Loans</div>
            <div class="rates-row"><span>Zero Deposit Home Loan</span><span class="rates-val rates-low">Unique</span></div>
            <div class="rates-row"><span>Construction Finance</span><span class="rates-val">Up to 90%</span></div>
            <div class="rates-category-label">üí≥ Personal Loans</div>
            <div class="rates-row"><span>Personal Finance</span><span class="rates-val rates-contact">Contact MF</span></div>
            <div class="rates-bank-link">Visit merchantfinancefiji.com ‚Üí</div>
          </a>

        </div>

        <!-- News Section -->
        <div class="section-title" style="margin-top:28px">üì∞ Fiji Loan News</div>
        <div class="rates-news-grid">
          <a class="rates-news-card" href="https://www.fbcnews.com.fj/" target="_blank"><span class="news-tag tag-mortgage">Mortgage</span><div class="rates-news-headline">FDB launches Choice Home Loan from 3.99% ‚Äî targets youth, women &amp; rural communities</div><div class="news-meta"><span class="news-source">FBC News</span> ¬∑ 2025</div></a>
          <a class="rates-news-card" href="https://www.fijivillage.com/" target="_blank"><span class="news-tag tag-mortgage">Mortgage</span><div class="rates-news-headline">Merchant Finance launches zero-deposit home loan ‚Äî first of its kind in Fiji</div><div class="news-meta"><span class="news-source">Fijivillage</span> ¬∑ 2025</div></a>
          <a class="rates-news-card" href="https://www.anz.com/fiji/en/interest-rates/" target="_blank"><span class="news-tag tag-vehicle">Vehicle</span><div class="rates-news-headline">ANZ Fiji car loan at 8.45% p.a. ‚Äî among the most competitive vehicle rates in Fiji</div><div class="news-meta"><span class="news-source">ANZ Fiji</span> ¬∑ Dec 2025</div></a>
          <a class="rates-news-card" href="https://www.westpac.com.fj/" target="_blank"><span class="news-tag tag-vehicle">Vehicle</span><div class="rates-news-headline">Westpac vehicle 1-yr fixed drops to 4.75% ‚Äî updated Jan 2026 rate sheet</div><div class="news-meta"><span class="news-source">Westpac Fiji</span> ¬∑ Jan 2026</div></a>
          <a class="rates-news-card" href="https://www.anz.com/fiji/en/interest-rates/" target="_blank"><span class="news-tag tag-personal">Personal</span><div class="rates-news-headline">ANZ personal: secured 10.50%, unsecured 16.50% ‚Äî current from Dec 2025</div><div class="news-meta"><span class="news-source">ANZ Fiji</span> ¬∑ Dec 2025</div></a>
          <a class="rates-news-card" href="https://www.rbf.gov.fj/" target="_blank"><span class="news-tag tag-mortgage">Policy</span><div class="rates-news-headline">RBF holds base lending rate at 1.67% for Q1 2025 ‚Äî aims to stimulate economic growth</div><div class="news-meta"><span class="news-source">Reserve Bank of Fiji</span> ¬∑ Q1 2025</div></a>
        </div>

        <div class="footer-note">‚ö†Ô∏è Rates are indicative only and subject to change. Always verify directly with each bank before making financial decisions. All amounts in FJD.</div>
      </div>

    </main>

  </div>
</div>

<!-- PWA Install Banner -->
<div id="pwa-banner">
  <div class="pwa-icon">üì≤</div>
  <div class="pwa-text">
    <div class="pwa-title">Install Finance Calculator</div>
    <div class="pwa-sub">Add to home screen ‚Äî works offline!</div>
  </div>
  <div class="pwa-actions">
    <button class="pwa-install-btn" id="pwa-install-btn">Install App</button>
    <button class="pwa-dismiss" onclick="dismissPWA()">Not now</button>
  </div>
</div>

<!-- Admin Panel -->
<div id="admin-panel">
  <div class="admin-wrap">

    <!-- Admin Login Gate -->
    <div id="admin-login-gate" class="admin-login" style="display:none">
      <div style="text-align:center;margin-bottom:20px">
        <div style="font-size:36px;margin-bottom:8px">üîê</div>
        <div style="font-size:18px;font-weight:800;margin-bottom:4px">Admin Access</div>
        <div style="font-size:13px;color:var(--muted)">Enter admin password to continue</div>
      </div>
      <div style="margin-bottom:14px">
        <input class="admin-input" type="password" id="admin-pw-input" placeholder="Admin password" onkeydown="if(event.key==='Enter')checkAdminPW()"/>
      </div>
      <button class="admin-save-btn" onclick="checkAdminPW()">Enter Admin Panel ‚Üí</button>
      <div class="admin-msg" id="admin-pw-msg"></div>
      <button onclick="closeAdmin()" style="width:100%;margin-top:10px;padding:10px;background:transparent;border:1px solid var(--border);color:var(--muted);border-radius:9px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:13px;">Cancel</button>
    </div>

    <!-- Admin Content -->
    <div id="admin-content" style="display:none">
      <div class="admin-header">
        <div>
          <div class="admin-title">‚öôÔ∏è Admin Panel</div>
          <div class="admin-subtitle">Update rates & news ‚Äî changes go live immediately</div>
        </div>
        <button class="admin-close" onclick="closeAdmin()">‚úï</button>
      </div>

      <!-- RBF Rate -->
      <div class="admin-section">
        <div class="admin-section-title">üè¶ Reserve Bank of Fiji Rate</div>
        <div class="admin-grid">
          <div class="admin-field">
            <label class="admin-label">Base Rate (%)</label>
            <input class="admin-input rate" type="number" step="0.01" id="adm-rbf-rate" placeholder="1.67"/>
          </div>
          <div class="admin-field">
            <label class="admin-label">Period (e.g. Q1 2025)</label>
            <input class="admin-input" type="text" id="adm-rbf-period" placeholder="Q1 2025"/>
          </div>
        </div>
      </div>

      <!-- Bank Rates -->
      <div class="admin-section">
        <div class="admin-section-title">üèõÔ∏è Bank Rates</div>
        <div id="admin-banks-container"></div>
      </div>

      <!-- News Items -->
      <div class="admin-section">
        <div class="admin-section-title">üì∞ News Items <span style="font-weight:400;font-size:10px;color:var(--muted)">(max 8)</span></div>
        <div id="admin-news-container"></div>
        <button class="admin-add-btn" onclick="addNewsItem()">+ Add News Item</button>
      </div>

      <!-- Save -->
      <button class="admin-save-btn" id="admin-save-btn" onclick="saveAdminData()">üíæ Save All Changes ‚Üí Goes Live Now</button>
      <div class="admin-msg" id="admin-msg"></div>
      <div style="text-align:center;font-size:11px;color:var(--muted);margin-top:10px;padding-bottom:20px">Changes are saved to Supabase and appear instantly for all users</div>
    </div>

  </div>
</div>
<div class="cpw-modal" id="cpw-modal">
  <div class="cpw-card">
    <div class="cpw-title">üîë Change Password</div>
    <div class="cpw-sub">Enter your new password below. You'll stay logged in after changing.</div>
    <div class="cpw-field"><label class="cpw-label">New Password <span style="text-transform:none;font-weight:400">(min. 8 chars)</span></label><input class="cpw-input" id="cpw-new" type="password" placeholder="New password"/></div>
    <div class="cpw-field"><label class="cpw-label">Confirm New Password</label><input class="cpw-input" id="cpw-confirm" type="password" placeholder="Repeat new password" onkeydown="if(event.key==='Enter')submitChangePassword()"/></div>
    <div class="cpw-msg" id="cpw-msg"></div>
    <div class="cpw-actions">
      <button class="cpw-btn cancel" onclick="closeChangePassword()">Cancel</button>
      <button class="cpw-btn primary" id="cpw-btn" onclick="submitChangePassword()">Update Password</button>
    </div>
  </div>
</div>

<!-- Share Modal -->
<div class="modal-overlay" id="share-modal">
  <div class="modal">
    <div class="modal-title">üîó Share Calculation</div>
    <div class="modal-sub">Anyone with this link can view this saved calculation (read-only).</div>
    <div class="share-link-box"><input class="share-link-input" id="share-link-val" readonly/><button class="btn btn-primary btn-sm" onclick="copyShareLink()">Copy</button></div>
    <div class="modal-actions"><button class="btn btn-outline" onclick="closeShareModal()">Close</button></div>
  </div>
</div>

<div id="toast"></div>
<script src="app.js"></script>
</body>
</html>
